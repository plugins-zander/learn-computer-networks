# 点到点链路的数据链路层协议PPP

##  PPP协议简介

由RFC 1661和RFC 2153定义的点到点协议（Point to Point Protocol，PPP）是用于一条直接连接两个结点的点到点链路上的链路层协议。运行PPP的点到点链路可能是一条串行的拨号电话线，它已经成为家庭用户和ISP之间通过拨号连接起来的协议。

PPP是TCP/IP网络协议包的一个成员，是TCP/IP的扩展，它增加了两个额外的功能组件：

（1）它可以通过串行接口传输TCP/IP包；（2）它可以安全登录。

## PPP协议的特点如下

+ （1）支持点到点的连接，不同于X.25、frame relay等数据链路层协议，具有CHAP、PAP验证协议，更好的保证了网络的安全性。
+ （2）PPP的物理层既支持数据为8位和无奇偶校验的异步模式，还支持面向比特位的同步链接，如frame relay必须为同步电路。
+ （3）PPP有针对不同网络层的网络控制协议，如IPCP，IPXCP。并且允许双方协商是否对报文首部进行压缩。
+ （4）提供了一整套方案解决链路建立、维护、折除上层协议协商、认证等问题。

## PPP协议的组成PPP 协议的组成

PPP 协议有三个组成部分 
+ 一个将 IP 数据报封装到串行链路的方法。
+ 链路控制协议 LCP (Link Control Protocol)，用来建立、配置和测试数据链路连接。
+ 网络控制协议 NCP (Network Control Protocol)，其中的每一个协议支持不同的网络层协议。  

## PPP协议的帧格式PPP 协议的帧格式

![](https://cdn.jsdelivr.net/gh/ZanderZhao/img20/file/20191105012226.png)





+ 标志字段 F = 0x7E （符号“0x”表示后面的字符是用十六进制表示。十六进制的 7E 的二进制表示是 01111110）。
+ 地址字段 A 只置为 0xFF。地址字段实际上并不起作用。
+ 控制字段 C 通常置为 0x03。
+ PPP 是面向字节的，所有的 PPP 帧的长度都是整数字节。     



PPP 有一个 2 个字节的协议字段。当协议字段为 0x0021 时，PPP 帧的信息字段就是IP 数据报。若为 0xC021, 则信息字段是 PPP 链路控制数据。若为 0x8021，则表示这是网络控制数据。  



## PPP协议的透明传输实现透明传输问题

当 PPP 用在异步传输时，就使用一种特殊的字符填充法。

当PPP使用异步传输时，它把转义符定义为0x7D，并使用字节填充。

当 PPP 用在同步传输链路时，协议规定采用硬件来完成比特填充。





### 字符填充 （RFC1662）

将信息字段中出现的每一个 0x7E 字节转变成为 2 字节序列(0x7D, 0x5E)。 

若信息字段中出现一个 0x7D 的字节, 则将其转变成为 2 字节序列(0x7D, 0x5D)。

若信息字段中出现 ASCII 码的控制字符（即数值小于 0x20 的字符），则在该字符前面要加入一个 0x7D 字节，同时将该字符的编码加以改变。  



![](https://cdn.jsdelivr.net/gh/ZanderZhao/img20/file/20191105012527.png)



PPP协议透明传输的字符填充法



### 零比特填充



PPP 协议用在 SONET/SDH 链路时，使用同步传输（一连串的比特连续传送）。这时 PPP 协议采用零比特填充方法来实现透明传输。

发送端：只要发现有 5 个连续 1，则立即填入一个 0。

接收端：每当发现 5 个连续1时，就把这 5 个连续 1 后的一个 0 删除，

![](https://cdn.jsdelivr.net/gh/ZanderZhao/img20/file/20191105012618.png)



零比特填充



## PPP 协议的链路状态PPP 协议的工作状态



当用户拨号接入 ISP 时，路由器的调制解调器对拨号做出确认，并建立一条物理连接。

PC 机向路由器发送一系列的 LCP 分组（封装成多个 PPP 帧）。这些分组及其响应选择将要使用的一些 PPP 参数。

接着进行网络层配置，NCP 给新接入的 PC机分配一个临时的 IP 地址，使 PC 机成为因特网上的一个主机。通信完毕时，NCP 释放网络层连接，收回原来分配出去的 IP 地址。接着，LCP 释放数据链路层连接。

最后释放的是物理层的连接。    



![](https://cdn.jsdelivr.net/gh/ZanderZhao/img20/file/20191105012808.png)

































































