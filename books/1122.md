# DNS服务

## 域名和域名系统

### 1.域名系统的概念

因特网编址有三种形式的地址管理机制：域名-IP地址-MAC地址

域名地址转换到IP地址由域名服务系统（Domain Name System，DNS）实现，这个转换过程又称为域名解析（Name Resolution）。

DNS（RFC 1035）也是TCP/IP的应用层协议之一。它利用了UDP传输层协议，端口为53。

域名系统（Domain Name System，DNS）主要是解决Internet上机器或设备命名的一种系统。它是Internet的一项服务，作为将域名和IP地址相互映射的一个分布式数据库，能够使人更方便地访问Internet。

> CS不需要用户域名解析服务不会因为DNS错误而无法访问

### 2.Internet的域名结构

Internet采用了层次（树状）结构的命名方法。

任何一个连接在Internet上的主机或路由器都有一个唯一的具有层次结构的名字，即域名。

域名的结构由若干个分量组成，各分量之间用点隔开，各分量分别代表不同级别的域名。

域名的格式为：四级域名．三级域名.二级域名.顶级域名。

通常对应为：机器名称．组织名称．组织类别．国家简称。

> www.nuist.edu.cn

![](https://raw.githubusercontent.com/ZanderZhao/images/master/img2019/20191217084330.png)

Internet的域名层次结构

```
顶级域名 TLD(Top Level Domain)

(1) 国家顶级域名 nTLD：如: .cn 表示中国，.us 表示美国，.uk 表示英国，等等。
(2) 通用顶级域名 gTLD：最早的顶级域名是：
    .com  （公司和企业）
    .net  （网络服务机构）
    .org  （非赢利性组织）
    .edu  （美国专用的教育机构）
    .gov  （美国专用的政府部门）
    .mil  （美国专用的军事部门）
    .int  （国际组织）
(3) 基础结构域名(infrastructure domain)：这种顶级域名只有一个，即 arpa，用于反向域名解析，因此又称为反向域名。 
(4) 新增加了下列的通用顶级域名 
.aero （航空运输企业）
.biz  （公司和企业）
.cat   （加泰隆人的语言和文化团体）
.coop  （合作团体）
.info  （各种情况）
.jobs  （人力资源管理者）
.mobi  （移动产品与服务的用户和提供者）
.museum  （博物馆）
.name   （个人）
.pro  （有证书的专业人员）
.travel  （旅游业） 

```





## 域名服务器

Internet允许各个单位根据具体情况将本单位的域名划分为若干个域名服务器管辖区( zone)，并在各管辖区中设置相应的授权域名服务器。

域名需要授权注册登记。

Internet划分为多个区域，每个区域中设一个授权域名服务器。

域名服务器有四种类型：根域名服务器\顶级域名服务器\权限域名服务器\本地域名服务器

树状结构的 DNS 域名服务器 

![](https://raw.githubusercontent.com/ZanderZhao/images/master/img2019/20191217090233.png)







## 域名解析



主机向本地域名服务器的查询一般都是采用递归查询。如果本地域名服务器不知道主机所询问的域名的 IP 地址，那么本地域名服务器就以 DNS 客户的身份，向其他根域名服务器继续发出查询请求报文。

本地域名服务器向根域名服务器的查询通常是采用迭代查询。当根域名服务器收到本地域名服务器的迭代查询请求报文时，要么给出所要查询的 IP 地址，要么告诉本地域名服务器：“你下一步应当向哪一个域名服务器进行查询”。然后让本地域名服务器进行后续的查询。





域名的高速缓存 

```
每个域名服务器都维护一个高速缓存，存放最近用过的名字以及从何处获得名字映射信息的记录。
可大大减轻根域名服务器的负荷，使因特网上的 DNS 查询请求和回答报文的数量大为减少。 
为保持高速缓存中的内容正确，域名服务器应为每项内容设置计时器，并处理超过合理时间的项（例如，每个项目只存放两天）。
当权限域名服务器回答一个查询请求时，在响应中都指明绑定有效存在的时间值。增加此时间值可减少网络开销，而减少此时间值可提高域名转换的准确性。 

```







![](https://raw.githubusercontent.com/ZanderZhao/images/master/img2019/20191223190943.png)



<center>本地域名服务器采用递归查询</center>

![](https://raw.githubusercontent.com/ZanderZhao/images/master/img2019/20191223191024.png)

<center>本地域名服务器采用迭代查询 </center>













