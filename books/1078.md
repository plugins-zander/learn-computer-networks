# 子网掩码

子网掩码

- 子网掩码的概念

  - 通过IP数据报的首部并不知道源主机或目的主机所连接的网络是否进行了子网划分。

  - 因为32位的IP地址本身以及IP数据报的首部都没有包含任何有关子网划分的信息。

  - 假定一个数据报（目的地址是128.9.15.1）已到达连接网络（ 128.9.0.0 ）的路由器R1，如何把它转发到子网（ 128.9.15.0 ）去呢？

  - 子网掩码的构成

    - 图示

      - 

        ![img](https://mubu.com/document_image/ff03d686-87df-414e-9160-2de6e10b2933-4644403.jpg)

    - 网络地址= (IP 地址) AND (子网掩码)

      - 

        ![img](https://mubu.com/document_image/07609d96-d244-4400-8bcb-e64660c4b30c-4644403.jpg)

- A 类、B 类和 C 类 IP 地址的默认子网掩码

  -  

    ![img](https://mubu.com/document_image/368cb83a-9b4c-46cd-a260-2c7aad3d343d-4644403.jpg)

- 子网掩码的使用

  - 计算主机所在子网的子网地址

    - 

      ![img](https://mubu.com/document_image/5281d3fc-b2cb-4adb-8a60-8acc763611e3-4644403.jpg)

      ![img](https://mubu.com/document_image/f137e49d-a86d-41a4-9596-8be0006665fe-4644403.jpg)

  - 规划子网

    - 【例5-2】

      - 某校园网从ISP获得B类地址202.240.0.0，现在根据需要划分为240个子网，问子网掩码应该设置为多少？这240个子网应如何划分？校园网未划分子网的结构如图5-29所示。

      - 图5-29

        - 

          ![img](https://mubu.com/document_image/fffb7d2d-00ac-4df8-8553-bad3075ca970-4644403.jpg)

      - 分析

        - 根据子网划分需求，原来的B类地址网络号部分占16比特，主机号部分占16比特，对应B类网络的默认子网掩码255.255.0.0。
        - 现在需要将原有的B类网络划分为240个子网， 因为27=128<240<256=28，则需要从原来的主机号部分至少借8比特来表示子网
        - 新的子网掩码由默认的子网掩码255.255.0.0变为255.255.255.0
        - 子网掩码中新增加的8个1对应IP地址中的子网号部分

      - 划分子网前后子网掩码的变化

        - 

          ![img](https://mubu.com/document_image/a10c7700-c9c4-4dce-93eb-3b7f958f2bc3-4644403.jpg)

      - B类网络子网划分结果（使用固定子网掩码）

        - 

          ![img](https://mubu.com/document_image/65c3650f-b169-47e2-b453-34a9a8a0de36-4644403.jpg)

      - 校园网划分子网后的结构

        - 

          ![img](https://mubu.com/document_image/34e09f99-c697-4141-932b-e28b8a196e76-4644403.jpg)

    - 子网划分总结

      - 若使用较少位数的子网号，则每一个子网上可连接的主机数就较多。反之，若使用较多位数的子网号，则子网的数目较多但每个子网上可连接的主机数就较少。
      - 可根据网络的具体情况(一共需要划分多少个子网，每个子网中最多有多少个主机)来选择合适的子网掩码。

  - 计算子网掩码，子网个数，子网内主机数；计算子网地址，子网广播地址

    - 【例5-3】如果将一个C类网络192.168.1.0划分为4个子网，请问：

      - ①新的子网掩码是多少？

        - 因为要划分为4个子网，而4=22（注：此处以工程应用为主，可以使用子网号部分全0或全1的子网，计算子网个数时不需要再减2），因此需要从主机号部分借用2个比特位表示相应子网，相应的子网掩码中由24个1增加为26个1。

        - 255.255.255.0→255.255.255.192

        - 图示

          - 

            ![img](https://mubu.com/document_image/b7cfa22a-11cb-4133-8a19-582c72e6d315-4644403.jpg)

      - ②每个子网的主机数是多少？

        - 由于借用2位标识子网，因此剩余的表示主机的主机号部分只有8-2=6个比特位，所以每个子网的主机数=26-2=62台。

      - ③每个子网的子网地址？子网广播地址？子网内主机IP地址范围？

        - 由于划分子网并不改变IP地址的网络号部分，因此整个网络中的IP地址前24比特保持不变，借用来表示子网的2个bit 位的变化形式有4种，分别是00，01，10，11，剩余的6个比特位表示主机，变化范围是（00 0000）2→（11 1111）2，因为主机号部分全为0对应的IP地址是一个子网地址，主机号部分全为1对应的IP地址是一个子网广播地址，因此每个子网内主机IP地址的主机号部分变化范围是（00 0001）2→（11 1110）2，对应的地址个数是26-2=62个。

      - C类网络192.168.1.0 IP地址空间的变化情况

        - 

          ![img](https://mubu.com/document_image/11821535-a3cb-4f9e-8002-8852b6bbecdf-4644403.jpg)

      - C类网络192.168.1.0的子网信息

        - 

          ![img](https://mubu.com/document_image/dba58a9b-93b5-4a13-9a69-065b7693278f-4644403.jpg)