# 应用层

​       应用层是TCP/IP模型的最高层，它通过使用传输层所提供的服务，直接向用户提供服务。它是TCP/IP网络与用户之间的界面或接口。该层由若干面向用户提供服务的应用协议和支持这些应用的支撑协议组成，基于这些协议，应用层向用户提供了众多的网络应用。

​       本章主要讨论域名系统DNS，万维网的工作原理及其主要协议，因特网电子邮件，文件传送协议FTP，远程终端协议TELNET、动态主机配置协议DHCP等。最后，介绍有关网络编程接口的概念。

```
7.1 TCP/IP的应用层
7.2 DNS服务
7.2.1 域名和域名系统
7.2.2 域名服务器
7.2.3 域名解析
7.3 WWW服务
7.3.1 WWW的基本概念
7.3.2 统一资源定位器
7.3.3 超文本传输协议
7.3.4 超文本标记语言
7.4 E-mail服务
7.4.1 电子邮件概述
7.4.2 电子邮件系统的组成
7.4.3 电子邮件的发送和接收过程
7.4.4 电子邮件的组成
7.4.5 简单邮件传输协议
7.4.6 邮件读取协议POP3和IMAP
7.4.7 通用Internet电子邮件扩充协议
7.5 FTP服务
7.6 远程终端服务
7.7 DHCP服务
7.7.1 引导程序协议
7.7.2 动态主机配置协议
7.8 网络应用编程接口
7.8.1 应用编程接口与socket编程
7.8.2 无连接循环服务与面向连接并发服务
7.9 小结


```









## 7.1 TCP/IP的应用层

TCP/IP应用层上的典型应用包括Web浏览、电子邮件、文件传输和远程终端等

与这些应用相关的协议包括超文本传输协议（HTTP）、简单邮件传输协议（SMTP）、文件传输协议（FTP）、简单文件传输协议（TFTP）和虚拟终端协议（Telnet）。

HTTP：用来在浏览器和WWW服务器之间传送超文本协议。

SMTP：用于实现电子邮件传输的应用协议。

FTP：用于实现文件传输服务的协议。通过FTP用户可以方便地连接到远程服务器，可以进行查看、删除、移动、复制、更改远程服务器上的文件内容，并能进行上传文件和下载文件等操作。

TFTP：用于提供小而简单的文件传输服务。TFTP是对FTP的一种补充，特别是在文件较小并且只有传输需求时该协议显得更加有效率。

Telnet：实现虚拟或仿真终端的服务，允许用户把自己的计算机当作远程主机上的一个终端连接到远程计算机，并使用基于文本界面的命令控制和管理远程主机上的文件及其他资源。

DNS：用于实现域名和IP地址之间的相互转换。

SNMP：由于Internet结构复杂，拥有众多的操作者，因此需要好的工具进行网络管理，以确保网络运行的可靠性和可管理性。而SNMP提供了一种监控和管理计算机网络的有效方法，它已成为计算机网络管理的事实标准。

> 自己编程获取路由器交换机流量数据，获取网络拓扑结构。用语言管理路由器和交互机用。



### 7.2.1 域名和域名系统

#### 1.域名系统的概念

因特网编址有三种形式的地址管理机制：

域名-IP地址-MAC地址

域名地址转换到IP地址由域名服务系统（Domain Name System，DNS）实现，这个转换过程又称为域名解析（Name Resolution）。

DNS（RFC 1035）也是TCP/IP的应用层协议之一。它利用了UDP传输层协议，端口为53。

域名系统（Domain Name System，DNS）主要是解决Internet上机器或设备命名的一种系统。它是Internet的一项服务，作为将域名和IP地址相互映射的一个分布式数据库，能够使人更方便地访问Internet。

> CS不需要用户域名解析服务不会因为DNS错误而无法访问

#### 2.Internet的域名结构

Internet采用了层次（树状）结构的命名方法。

任何一个连接在Internet上的主机或路由器都有一个唯一的具有层次结构的名字，即域名。

域名的结构由若干个分量组成，各分量之间用点隔开，各分量分别代表不同级别的域名。

域名的格式为：四级域名．三级域名.二级域名.顶级域名。

通常对应为：机器名称．组织名称．组织类别．国家简称。

> www.nuist.edu.cn

![](https://raw.githubusercontent.com/ZanderZhao/images/master/img2019/20191217084330.png)

Internet的域名层次结构

顶级域名 TLD(Top Level Domain)

```
(1) 国家顶级域名 nTLD：如: .cn 表示中国，.us 表示美国，.uk 表示英国，等等。
(2) 通用顶级域名 gTLD：最早的顶级域名是：
    .com  （公司和企业）
    .net  （网络服务机构）
    .org  （非赢利性组织）
    .edu  （美国专用的教育机构）
    .gov  （美国专用的政府部门）
    .mil  （美国专用的军事部门）
    .int  （国际组织）
(3) 基础结构域名(infrastructure domain)：这种顶级域名只有一个，即 arpa，用于反向域名解析，因此又称为反向域名。 
新增加了下列的通用顶级域名 
.aero （航空运输企业）
.biz  （公司和企业）
.cat   （加泰隆人的语言和文化团体）
.coop  （合作团体）
.info  （各种情况）
.jobs  （人力资源管理者）
.mobi  （移动产品与服务的用户和提供者）
.museum  （博物馆）
.name   （个人）
.pro  （有证书的专业人员）
.travel  （旅游业） 



```





### 7.2.2 域名服务器

Internet允许各个单位根据具体情况将本单位的域名划分为若干个域名服务器管辖区( zone)，并在各管辖区中设置相应的授权域名服务器。

域名需要授权注册登记。

Internet划分为多个区域，每个区域中设一个授权域名服务器。

域名服务器有四种类型：根域名服务器\顶级域名服务器\权限域名服务器\本地域名服务器

树状结构的 DNS 域名服务器 

![](https://raw.githubusercontent.com/ZanderZhao/images/master/img2019/20191217090233.png)







### 7.2.3 域名解析



主机向本地域名服务器的查询一般都是采用递归查询。如果本地域名服务器不知道主机所询问的域名的 IP 地址，那么本地域名服务器就以 DNS 客户的身份，向其他根域名服务器继续发出查询请求报文。

本地域名服务器向根域名服务器的查询通常是采用迭代查询。当根域名服务器收到本地域名服务器的迭代查询请求报文时，要么给出所要查询的 IP 地址，要么告诉本地域名服务器：“你下一步应当向哪一个域名服务器进行查询”。然后让本地域名服务器进行后续的查询。





域名的高速缓存 

```
每个域名服务器都维护一个高速缓存，存放最近用过的名字以及从何处获得名字映射信息的记录。
可大大减轻根域名服务器的负荷，使因特网上的 DNS 查询请求和回答报文的数量大为减少。 
为保持高速缓存中的内容正确，域名服务器应为每项内容设置计时器，并处理超过合理时间的项（例如，每个项目只存放两天）。
当权限域名服务器回答一个查询请求时，在响应中都指明绑定有效存在的时间值。增加此时间值可减少网络开销，而减少此时间值可提高域名转换的准确性。 

```





### 7.3.1 WWW的基本概念



1. WWW

   WWW（World Wide Web）也称为万维网、环球信息网、3W或WEB，是一个大规模的、联机式的信息储藏所。

   万维网用链接的方法非常方便地从因特网上的一个站点访问另一个站点，从而主动地按需获取丰富的信息。这种访问方式称为“链接”。

   万维网是分布式超媒体（hypermedia）系统，是超文本（hypertext）系统的扩充。



万维网的分布式超媒体系统

![](https://raw.githubusercontent.com/ZanderZhao/images/master/img2019/20191217090537.png)

2. 万维网设计目标

```
分布式信息系统；
对多重协议提供一个统一通用的接口；
对超媒体支持；
可扩充性，能够支持所有的数据格式

```



3.万维网必须解决的问题

```

 



```





（1）怎样标志分布在整个因特网上的万维网文档？

使用统一资源定位符 URL (Uniform Resource Locator)来标志万维网上的各种文档。使每一个文档在整个因特网的范围内具有唯一的标识符 URL。



（2）用什么协议实现万维网上各种超链接？

在万维网客户程序与万维网服务器程序之间进行交互所使用的协议，是超文本传送协议 HTTP (Hyper Text Transfer Protocol)。HTTP 是一个应用层协议，它使用 TCP 连接进行可靠的传送。





（3）怎样使各种万维网文档都能在因特网上的各种计算机上显示出来，同时使用户清楚地知道在什么地方存在着超链接？

超文本标记语言 HTML (Hyper Text Markup Language)使得万维网页面的设计者可以很方便地用一个超链接从本页面的某处链接到因特网上的任何一个万维网页面，并且能够在自己的计算机屏幕上将这些页面显示出来。



（4）怎样使用户能够很方便地找到所需的信息？ 

为了在万维网上方便地查找信息，用户可使用各种的搜索工具（即搜索引擎）。





### 7.3.2 统一资源定位器

统一资源定位器，又叫URL（Uniform Resource Locator），是专为标识Internet网上资源位置而设的一种编址方式。

现在已成为因特网标准RFC1738

URL一般由四个部分组成

传输协议：//主机名或IP地址或域名/资源所在路径/文件名

http://www.gov.cn/xinwen/2016-03/25/content_5058199.htm





URL 的一般形式 

由以冒号隔开的两大部分组成，并且在 URL 中的字符对大写或小写没有要求。

URL 的一般形式是：

![](https://raw.githubusercontent.com/ZanderZhao/images/master/img2019/20191217091110.png)







7.3.3 超文本传输协议

1.HTTP概述

HTTP的全称是Hypertext Transfer Protocol，即超文本传输协议。作为一种应用层协议，HTTP在可靠的网络层协议基础上提供了在Web服务器和客户之间传输  信息的一种机制，并规定了客户与服务器之间交互的各种消息。HTTP是一个应用层的面向对象的协议，由于其简捷、快速的方式，适用于分布式超媒体信息系统。

HTTP实现Web上的文件传输，通过使用HTTP协议，客户可从Web服务器上下载几乎所有类型的文件，包括HTML文件，图像，视频／音频等多媒体文件，Java Applet等对象。客户也可以向Web服务器上传几乎所有类型的文件。HTTP还可以将用户在客户端输入 的各种信息提交给Web服务 器，从而实现基于Web的动态、交互式应用。



```
HTTP协议的主要特点：
（1）支持客户/服务器模式。
（2）简单快速：客户向服务器请求服务时，只需传送请求方法和路径。
（3）灵活：HTTP允许传输任意类型的数据对象。
（4）无连接：
（5）无状态：HTTP协议是无状态协议。

```



```
HTTP 有两类报文：
请求报文——从客户向服务器发送请求报文。
响应报文——从服务器到客户的回答。
由于 HTTP 是面向正文的(text-oriented)，因此在报文中的每一个字段都是一些 ASCII 码串，因而每个字段的长度都是不确定的。

```





## 7.4 E-mail服务

电子邮件（e-mail）是因特网上最典型的服务之一，在因特网中出现最早，应用最普遍、最广泛。

因特网用户中90％以上都使用过电子邮件。电子邮件把邮件发送到收件人使用的邮件服务器，并放在其中的收件人邮箱中，收件人可随时上网到自己使用的邮件服务器进行读取。

这相当于因特网为用户设立了存放邮件的信箱，因此e-mail有时也称为“电子信箱”。

电子邮件方便、快捷、廉价的优点。



### 7.4.1 电子邮件概述

1982年，简单邮件传送协议（Simple Mail Transfer Protocol，SMTP）和Internet文本报文格式成为Internet的正式标准。

1993年，通用Internet邮件扩充（Multipurpose Internet  Mail Extensions，MIME）协议在邮件首部中说明了邮件的数据类型（如文本、声音、图像、视频等），使得在MIME邮件可同时传送多种类型的数据。



### 7.4.2 电子邮件系统的组成

电子邮件系统有3个主要组成部分，即用户代理（User Agent，UA）、邮件服务器和简单件传输协议（SMTP）和邮件读取协议（如POP3）。

![](https://raw.githubusercontent.com/ZanderZhao/images/master/img2019/20191217093205.png)



用户代理 UA (User Agent)

```
用户代理 UA 就是用户与电子邮件系统的接口，是电子邮件客户端软件。
用户代理的功能：撰写、显示、处理和通信。
邮件服务器的功能是发送和接收邮件，同时还要向发信人报告邮件传送的情况（已交付、被拒绝、丢失等）。
邮件服务器按照客户服务器方式工作。邮件服务器需要使用发送和读取两个不同的协议。

```







### 7.4.3 电子邮件的发送和接收过程



![](https://raw.githubusercontent.com/ZanderZhao/images/master/img2019/20191217093456.png)



（1）发信人调用用户代理来编辑要发送的邮件。用户代理用SMTP把邮件传送给发送端邮件服务器。（2）发送端邮件服务器将邮件放入邮件缓存队列中，等待发送。因为邮件过多，所以需要等待。如果想要避免缓冲溢出导致邮件丢失，发信人可以避开邮件收发高峰期后再发送邮件。（3）运行在发送端邮件服务器的SMTP客户进程发现在邮件缓存中有待发送的邮件，就向运行在接收端邮件服务器的SMTP服务器进程发STCP连接的建立。

（4）TCP连接建立后，SMTP客户进程开始向远程的SMTP服务器进程发送邮件。当所有的待发送邮件发完了，SMTP就关闭所建立的TCP连接。（5）运行在接收端邮件服务器中的SMTP服务器进程收到邮件后，将邮件放入收信人的用户邮箱中，等待收信人在方便时进行读取。（6）收信人在打算收信时，调用用户代理，使用POP3（或IMAP）协议将自己的邮件从接收端邮件服务器的用户邮箱中取回（如果邮箱中有来信的话）。







### 7.4.4 电子邮件的组成



标准的电子邮件信息由两部分组成：邮件头（header）邮件体（body）邮件头相当于“信封”，主要包括收件人地址、投递日期、邮件主题、发件人地址。邮件体就是邮件正文、内容，相当于装在信封内的信。

















































































































































