# 子网划分

## 分类IP地址的面临的问题

- 在ARPANET早期，IP地址的设计不够合理
  - IP地址空间的利用率有时很低

  - 给每个物理网络分配一个网络号使路由表变得太大，使网络的性能变坏

  - 两级IP地址不够灵活

  - > 在一个冲突域里，好比同一个文件夹里面有好多文件

## 划分子网的思想（从两级 IP 地址到三级 IP 地址 ）

- 三级的 IP 地址

  - 为解决上述问题，从 1985 年起在 IP 地址中又增加了一个“子网号字段”，使两级 IP 地址变成为三级 IP 地址。

  - 这种做法叫作划分子网(sub netting) 。划分子网已成为因特网的正式标准协议。

    ![img](https://cdn.jsdelivr.net/gh/ZanderZhao/img20/file/20200115191447.png)

- 划分子网的基本思路

  - 划分子网纯属一个单位内部的事情。

  - 从主机号借用若干个比特作为子网号 subnet-id。

  - 从其他网络发送给本单位主机的 IP 数据报，仍然根据 IP 数据报的目的网络号 net-id，先找到连接在本单位网络上的路由器。

  - 然后此路由器在收到 IP 数据报后，再按目的网络号 net-id 和子网号 subnet-id 找到目的子网。

  - 最后就将 IP 数据报直接交付给目的主机。

    ![img](https://cdn.jsdelivr.net/gh/ZanderZhao/img20/file/20200115191448.png)

- 子网划分(subnetting) 的优点

  - 实现更小的广播域，减少网络流量；
  - 更好的利用IP地址空间，提高网络性能；
  - 使不同物理空间的主机使用同一网络地址，简化管理；
  - 易于扩大地理范围。

## 划分子网的步骤

- 确定能够对哪个具体的网络地址进行子网划分。
- 根据现在所需的子网数以及每个子网中所包含的主机数，用主机号的一些比特位来表示子网。
- 划分子网的个数和每个子网中包含主机个数的公式计算：
  - 假设子网号部分占用m个比特位数，主机号部分占用n个比特位数，那么子网数=$2^m$个；每个子网包含主机数=$2^n-2$台（不包含全0和全1的主机号）。

> 现在我们已经知道怎么划分了，就是分一个子网号段出来，可以怎么表示分出来，就是子网掩码和CIDR