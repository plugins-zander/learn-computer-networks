# Tracert&Traceroute(win/linux)

**traceroute**，现代也有[Linux](https://zh.wikipedia.org/wiki/Linux)系统称为**tracepath**，[Windows](https://zh.wikipedia.org/wiki/Windows)系统称为**tracert**，是一种电脑网络工具。它可显示[数据包](https://zh.wikipedia.org/wiki/%E5%B0%81%E5%8C%85)在IP网络经过的[路由器](https://zh.wikipedia.org/wiki/%E8%B7%AF%E7%94%B1%E5%99%A8)的[IP地址](https://zh.wikipedia.org/wiki/IP%E4%BD%8D%E5%9D%80)。

```
//win为例
一、功能
       tracert 命令跟踪 TCP/IP 数据包从该计算机到其他远程计算机所采用的路径。tracert 命令使用 ICMP 响应请求并答复消息（和 ping 命令类似），产生关于经过的每个路由器及每个跃点的往返时间 (RTT) 的命令行报告输出。 
二、格式
键入     tracert host_name
或者键入  tracert ip_address
三、举例
tracert www.microsoft.com
Tracert  192.168.0.100

```

## 原理

程序是利用增加[存活时间](https://zh.wikipedia.org/wiki/%E5%AD%98%E6%B4%BB%E6%99%82%E9%96%93)（TTL）值来实现其功能的。每当数据包经过一个路由器，其存活时间就会减1。当其存活时间是0时，主机便取消数据包，并发送一个[ICMP](https://zh.wikipedia.org/wiki/ICMP) TTL数据包给原数据包的发出者。

程序发出的首3个数据包TTL值是1，之后3个是2，如此类推，它便得到一连串数据包路径。注意IP不保证每个数据包走的路径都一样。

## 实现

主叫方首先发出 TTL=1 的数据包，第一个路由器将 TTL 减1得0后就不再继续转发此数据包，而是返回一个 ICMP 逾时报文，主叫方从逾时报文中即可提取出数据包所经过的第一个网关地址。然后又发出一个 TTL=2 的 ICMP 数据包，可获得第二个网关地址，依次递增 TTL 便获取了沿途所有网关地址。

需要注意的是，并不是所有网关都会如实返回 ICMP 超时报文。出于安全性考虑，大多数防火墙以及启用了防火墙功能的路由器缺省配置为不返回各种 ICMP 报文，其余路由器或[交换机](https://zh.wikipedia.org/wiki/%E4%BA%A4%E6%8D%A2%E6%9C%BA)也可被管理员主动修改配置变为不返回 ICMP 报文。因此 Traceroute 程序不一定能拿全所有的沿途网关地址。所以，当某个 TTL 值的数据包得不到响应时，并不能停止这一追踪过程，程序仍然会把 TTL 递增而发出下一个数据包。一直达到默认或用参数指定的追踪限制（maximum_hops）才结束追踪。

依据上述原理，利用了 UDP 数据包的 Traceroute 程序在数据包到达真正的目的主机时，就可能因为该主机没有提供 [UDP](https://zh.wikipedia.org/wiki/UDP) 服务而简单将数据包抛弃，并不返回任何信息。为了解决这个问题，Traceroute 故意使用了一个大于 30000 的端口号，因 UDP 协议规定端口号必须小于 30000 ，所以目标主机收到数据包后唯一能做的事就是返回一个“端口不可达”的 ICMP 报文，于是主叫方就将端口不可达报文当作跟踪结束的标志。

## 历史

根据traceroute的[man page](https://zh.wikipedia.org/wiki/Man_page)：1987年，Steve Deering建议Van Jacobson写一个这样的程序。C. Philip Wood、Tim Seaver和Ken Adelman为这个程序提供一些意见或改动。

[Windows NT](https://zh.wikipedia.org/wiki/Windows_NT)系统有结合[ping](https://zh.wikipedia.org/wiki/Ping)和traceroute的pathping工具。

## 命令

### win7x64

```
tracert \?
```

```bash
用法: tracert [-d] [-h maximum_hops] [-j host-list] [-w timeout]
               [-R] [-S srcaddr] [-4] [-6] target_name

选项:
    -d                 不将地址解析成主机名。
    -h maximum_hops    搜索目标的最大跃点数。
    -j host-list       与主机列表一起的松散源路由(仅适用于 IPv4)。
    -w timeout         等待每个回复的超时时间(以毫秒为单位)。
    -R                 跟踪往返行程路径(仅适用于 IPv6)。
    -S srcaddr         要使用的源地址(仅适用于 IPv6)。
    -4                 强制使用 IPv4。
    -6                 强制使用 IPv6。
```

### linux-deepin15.11

```
sudo apt install strace traceroute
```

```
man traceroute
```

```
TRACEROUTE(1)               Traceroute For Linux               TRACEROUTE(1)

NAME
       traceroute - print the route packets trace to network host

SYNOPSIS
       traceroute [-46dFITUnreAV] [-f first_ttl] [-g gate,...]
               [-i device] [-m max_ttl] [-p port] [-s src_addr]
               [-q nqueries] [-N squeries] [-t tos]
               [-l flow_label] [-w waittimes] [-z sendwait] [-UL] [-D]
               [-P proto] [--sport=port] [-M method] [-O mod_options]
               [--mtu] [--back]
               host [packet_len]
       traceroute6  [options]
       tcptraceroute  [options]
       lft  [options]

DESCRIPTION
       traceroute tracks the route packets taken from an IP network on their
       way to a given host. It utilizes the IP protocol's time to live (TTL)
       field and attempts to elicit an ICMP TIME_EXCEEDED response from each
       gateway along the path to the host.

       traceroute6 is equivalent to traceroute -6

       tcptraceroute is equivalent to traceroute -T

       lft , the Layer Four Traceroute,  performs  a  TCP  traceroute,  like
       traceroute -T , but attempts to provide compatibility with the origi‐
       nal such implementation, also called "lft".

       The only required parameter is the name or IP address of the destina‐
       tion  host .   The  optional  packet_len`gth is the total size of the
       probing packet (default 60 bytes for IPv4 and 80 for IPv6). The spec‐
       ified  size  can  be  ignored in some situations or increased up to a
       minimal value.

       This program attempts to trace the route an IP packet would follow to
       some  internet host by launching probe packets with a small ttl (time
       to live) then listening for an ICMP  "time  exceeded"  reply  from  a
       gateway.   We  start our probes with a ttl of one and increase by one
       until we get an ICMP "port unreachable" (or TCP reset),  which  means
       we got to the "host", or hit a max (which defaults to 30 hops). Three
       probes (by default) are sent at  each  ttl  setting  and  a  line  is
       printed  showing  the ttl, address of the gateway and round trip time
       of each probe. The address can be followed by additional  information
       when  requested.  If  the probe answers come from different gateways,
       the address of each responding system will be printed.  If  there  is
       no  response  within  a certain timeout, an "*" (asterisk) is printed
       for that probe.


       After the trip time, some additional annotation can be  printed:  !H,
       !N,  or  !P (host, network or protocol unreachable), !S (source route
       failed), !F (fragmentation  needed),  !X  (communication  administra‐
       tively  prohibited),  !V  (host precedence violation), !C (precedence
       cutoff in effect), or  !<num>  (ICMP  unreachable  code  <num>).   If
       almost  all the probes result in some kind of unreachable, traceroute
       will give up and exit.

       We don't want the destination host to process the UDP probe  packets,
       so  the  destination port is set to an unlikely value (you can change
       it with the -p flag). There is no such a  problem  for  ICMP  or  TCP
       tracerouting  (for TCP we use half-open technique, which prevents our
       probes to be seen by applications on the destination host).

       In the modern network environment the traditional traceroute  methods
       can not be always applicable, because of widespread use of firewalls.
       Such firewalls filter the "unlikely" UDP ports, or even ICMP  echoes.
       To  solve  this, some additional tracerouting methods are implemented
       (including tcp), see LIST OF AVAILABLE METHODS  below.  Such  methods
       try  to use particular protocol and source/destination port, in order
       to bypass firewalls (to be seen by  firewalls  just  as  a  start  of
       allowed type of a network session).

OPTIONS
       --help Print help info and exit.

       -4, -6 Explicitly  force  IPv4  or IPv6 tracerouting. By default, the
              program will try to resolve the name  given,  and  choose  the
              appropriate  protocol  automatically. If resolving a host name
              returns both IPv4 and  IPv6  addresses,  traceroute  will  use
              IPv4.

       -I, --icmp
              Use ICMP ECHO for probes

       -T, --tcp
              Use TCP SYN for probes

       -d, --debug
              Enable  socket level debugging (when the Linux kernel supports
              it)

       -F, --dont-fragment
              Do not fragment probe packets. (For IPv4 it also sets DF  bit,
              which  tells  intermediate routers not to fragment remotely as
              well).
              Varying the size of the probing packet by the packet_len  com‐
              mand line parameter, you can manually obtain information about
              the MTU of individual network  hops.  The  --mtu  option  (see
              below) tries to do this automatically.

              Note,  that  non-fragmented  features  (like -F or --mtu) work
              properly since the Linux kernel 2.6.22 only.  Before that ver‐
              sion,  IPv6 was always fragmented, IPv4 could use the once the
              discovered final mtu only (from the route cache), which can be
              less than the actual mtu of a device.

       -f first_ttl, --first=first_ttl
              Specifies with what TTL to start. Defaults to 1.

       -g gateway, --gateway=gateway
              Tells  traceroute  to  add  an IP source routing option to the
              outgoing packet that tells the network  to  route  the  packet
              through  the  specified  gateway  (most  routers have disabled
              source routing for security  reasons).   In  general,  several
              gateway's  is allowed (comma separated). For IPv6, the form of
              num,addr,addr...  is allowed, where num is a route header type
              (default  is type 2). Note the type 0 route header is now dep‐
              recated (rfc5095).

       -i interface, --interface=interface
              Specifies the interface through which traceroute  should  send
              packets.  By  default,  the interface is selected according to
              the routing table.

       -m max_ttl, --max-hops=max_ttl
              Specifies the maximum number of hops (max time-to-live  value)
              traceroute will probe. The default is 30.

       -N squeries, --sim-queries=squeries
              Specifies the number of probe packets sent out simultaneously.
              Sending several probes concurrently can  speed  up  traceroute
              considerably. The default value is 16.
              Note that some routers and hosts can use ICMP rate throttling.
              In such a situation specifying too large number  can  lead  to
              loss of some responses.

       -n     Do  not  try to map IP addresses to host names when displaying
              them.
       -p port, --port=port
              For UDP tracing, specifies the destination port  base  tracer‐
              oute will use (the destination port number will be incremented
              by each probe).
              For ICMP tracing, specifies the initial  ICMP  sequence  value
              (incremented by each probe too).
              For  TCP  and others specifies just the (constant) destination
              port to connect. When  using  the  tcptraceroute  wrapper,  -p
              specifies the source port.

       -t tos, --tos=tos
              For  IPv4, set the Type of Service (TOS) and Precedence value.
              Useful values are 16 (low delay) and 8 (high throughput). Note
              that  in  order to use some TOS precedence values, you have to
              be super user.
              For IPv6, set the Traffic Control value.

       -l flow_label, --flowlabel=flow_label
              Use specified flow_label for IPv6 packets.

       -w max[,here,near], --wait=max[,here,near]
              Determines how long to wait for a response to a probe.

              There are three (in general) float values separated by a comma
              (or  a  slash).   Max  specifies the maximum time (in seconds,
              default 5.0) to wait, in any case.

              Traditional traceroute implementation always waited whole  max
              seconds  for  any  probe.  But if we already have some replies
              from the same hop, or even from some next hop, we can use  the
              round  trip  time  of  such a reply as a hint to determine the
              actual reasonable amount of time to wait.

              The optional here (default 3.0) specifies a factor to multiply
              the  round  trip time of an already received response from the
              same hop. The resulting value is used as  a  timeout  for  the
              probe,  instead  of (but no more than) max.  The optional near
              (default 10.0) specifies a similar factor for a response  from
              some next hop.  (The time of the first found result is used in
              both cases).

              First, we look for the same hop (of the probe  which  will  be
              printed first from now).  If nothing found, then look for some
              next hop. If nothing found, use max.  If here and/or near have
              zero values, the corresponding computation is skipped.
              Here  and near are always set to zero if only max is specified
              (for compatibility with previous versions).
       -q nqueries, --queries=nqueries
              Sets the number of probe packets per hop. The default is 3.

       -r     Bypass the normal routing tables and send directly to  a  host
              on  an  attached  network.   If the host is not on a directly-
              attached network, an error is returned.  This  option  can  be
              used  to  ping  a  local host through an interface that has no
              route through it.

       -s source_addr, --source=source_addr
              Chooses an alternative source  address.  Note  that  you  must
              select  the address of one of the interfaces.  By default, the
              address of the outgoing interface is used.

       -z sendwait, --sendwait=sendwait
              Minimal time interval between  probes  (default  0).   If  the
              value is more than 10, then it specifies a number in millisec‐
              onds, else it is a  number  of  seconds  (float  point  values
              allowed  too).   Useful  when  some routers use rate-limit for
              ICMP messages.

       -e, --extensions
              Show  ICMP  extensions  (rfc4884).   The   general   form   is
              CLASS/TYPE:   followed   by  a  hexadecimal  dump.   The  MPLS
              (rfc4950)     is     shown     parsed,     in     a      form:
              MPLS:L=label,E=exp_use,S=stack_bottom,T=TTL (more objects sep‐
              arated by / ).

       -A, --as-path-lookups
              Perform AS  path  lookups  in  routing  registries  and  print
              results directly after the corresponding addresses.

       -V, --version
              Print the version and exit.

       There  are  additional  options  intended for advanced usage (such as
       alternate trace methods etc.):

       --sport=port
              Chooses the source port to use. Implies -N 1 -w 5 .   Normally
              source ports (if applicable) are chosen by the system.

       --fwmark=mark
              Set  the  firewall  mark for outgoing packets (since the Linux
              kernel 2.6.25).
       -M method, --module=name
              Use specified method for traceroute operations. Default tradi‐
              tional  udp  method  has  name default, icmp (-I) and tcp (-T)
              have names icmp and tcp respectively.
              Method-specific options can be passed by  -O .   Most  methods
              have their simple shortcuts, (-I means -M icmp, etc).

       -O option, --options=options
              Specifies  some  method-specific  option.  Several options are
              separated by comma (or  use  several  -O  on  cmdline).   Each
              method  may  have  its  own specific options, or many not have
              them at all.  To print information  about  available  options,
              use -O help.

       -U, --udp
              Use  UDP  to  particular  destination  port  for  tracerouting
              (instead of increasing the port per each probe). Default  port
              is 53 (dns).

       -UL    Use UDPLITE for tracerouting (default port is 53).

       -D, --dccp
              Use DCCP Requests for probes.

       -P protocol, --protocol=protocol
              Use raw packet of specified protocol for tracerouting. Default
              protocol is 253 (rfc3692).

       --mtu  Discover MTU along the path  being  traced.  Implies  -F -N 1.
              New  mtu is printed once in a form of F=NUM at the first probe
              of a hop which requires such mtu to be reached. (Actually, the
              correspond  "frag needed" icmp message normally is sent by the
              previous hop).
              Note, that some routers might cache once the seen  information
              on  a fragmentation. Thus you can receive the final mtu from a
              closer hop.  Try to specify an unusual tos by -t  ,  this  can
              help for one attempt (then it can be cached there as well).
              See -F option for more info.

       --back Print the number of backward hops when it seems different with
              the forward direction. This number is  guessed  in  assumption
              that  remote  hops  send reply packets with initial ttl set to
              either 64, or 128 or 255 (which seems a common  practice).  It
              is printed as a negate value in a form of '-NUM' .

LIST OF AVAILABLE METHODS
       In  general,  a particular traceroute method may have to be chosen by
       -M name, but most of the methods have their simple  cmdline  switches
       (you can see them after the method name, if present).

   default
       The traditional, ancient method of tracerouting. Used by default.

       Probe packets are udp datagrams with so-called "unlikely" destination
       ports.  The "unlikely" port of the first probe  is  33434,  then  for
       each  next  probe  it  is  incremented  by  one.  Since the ports are
       expected to be unused, the destination host  normally  returns  "icmp
       unreach  port"  as a final response.  (Nobody knows what happens when
       some application listens for such ports, though).

       This method is allowed for unprivileged users.
   icmp       -I
       Most usual method for now, which uses icmp echo packets for probes.
       If you can ping(8) the destination host, icmp tracerouting is  appli‐
       cable as well.

       This  method  may  be allowed for unprivileged users since the kernel
       3.0 (IPv4, for IPv6 since 3.11), which supports new  dgram  icmp  (or
       "ping")  sockets.  To  allow  such  sockets,  sysadmin should provide
       net/ipv4/ping_group_range sysctl range to  match  any  group  of  the
       user.
       Options:

       raw    Use only raw sockets (the traditional way).
              This  way  is  tried  first by default (for compatibility rea‐
              sons), then new dgram icmp sockets as fallback.

       dgram  Use only dgram icmp sockets.

   tcp        -T
       Well-known modern method, intended to bypass firewalls.
       Uses the constant destination port (default is 80, http).

       If some filters are present in the network path, then  most  probably
       any  "unlikely" udp ports (as for default method) or even icmp echoes
       (as for icmp) are filtered, and whole tracerouting will just stop  at
       such  a  firewall.   To  bypass a network filter, we have to use only
       allowed protocol/port  combinations.  If  we  trace  for  some,  say,
       mailserver,  then more likely -T -p 25 can reach it, even when -I can
       not.

       This method uses well-known  "half-open  technique",  which  prevents
       applications  on  the destination host from seeing our probes at all.
       Normally, a tcp syn is sent. For non-listened ports  we  receive  tcp
       reset,  and  all  is  done. For active listening ports we receive tcp
       syn+ack, but answer by tcp reset (instead of expected tcp ack),  this
       way  the  remote  tcp session is dropped even without the application
       ever taking notice.

       There is a couple of options for tcp method:

       syn,ack,fin,rst,psh,urg,ece,cwr
              Sets specified tcp flags for probe packet, in any combination.

       flags=num
              Sets the flags field in the tcp header exactly to num.

       ecn    Send syn packet with tcp flags ECE and CWR (for Explicit  Con‐
              gestion Notification, rfc3168).

       sack,timestamps,window_scaling
              Use  the corresponding tcp header option in the outgoing probe
              packet.

       sysctl Use current  sysctl  (/proc/sys/net/*)  setting  for  the  tcp
              header options above and ecn.  Always set by default, if noth‐
              ing else specified.

       mss=num
              Use value of num for maxseg tcp header option (when syn).

       info   Print tcp flags of final tcp replies when the target  host  is
              reached.   Allows  to determine whether an application listens
              the port and other useful things.

       Default options is syn,sysctl.
   tcpconn
       An initial implementation of  tcp  method,  simple  using  connect(2)
       call, which does full tcp session opening. Not recommended for normal
       use, because a destination application is always affected (and can be
       confused).

   udp        -U
       Use udp datagram with constant destination port (default 53, dns).
       Intended to bypass firewall as well.

       Note,  that  unlike  in tcp method, the correspond application on the
       destination host always receive our probes (with  random  data),  and
       most  can  easily be confused by them. Most cases it will not respond
       to our packets though, so we will never see  the  final  hop  in  the
       trace.  (Fortunately, it seems that at least dns servers replies with
       something angry).

       This method is allowed for unprivileged users.

   udplite    -UL
       Use udplite datagram for  probes  (with  constant  destination  port,
       default 53).

       This method is allowed for unprivileged users.
       Options:

       coverage=num
              Set udplite send coverage to num.

   dccp    -D
       Use DCCP Request packets for probes (rfc4340).

       This method uses the same "half-open technique" as used for TCP.  The
       default destination port is 33434.

       Options:

       service=num
              Set DCCP service code to num (default is 1885957735).

   raw        -P proto
       Send raw packet of protocol proto.
       No protocol-specific headers are used, just IP header only.
       Implies -N 1 -w 5 .
       Options:

       protocol=proto
              Use IP protocol proto (default 253).
NOTES
       To speed up work, normally several probes  are  sent  simultaneously.
       On  the  other  hand, it creates a "storm of packages", especially in
       the reply direction. Routers can throttle the rate of icmp responses,
       and  some  of replies can be lost. To avoid this, decrease the number
       of simultaneous probes, or even set it to 1 (like in initial  tracer‐
       oute implementation), i.e.  -N 1

       The final (target) host can drop some of the simultaneous probes, and
       might even answer only the latest ones. It can lead to  extra  "looks
       like  expired"  hops  near the final hop. We use a smart algorithm to
       auto-detect such a situation, but if it cannot  help  in  your  case,
       just use -N 1 too.

       For even greater stability you can slow down the program's work by -z
       option, for example use -z 0.5 for half-second pause between probes.

       To avoid an extra waiting, we use  adaptive  algorithm  for  timeouts
       (see -w option for more info). It can lead to premature expiry (espe‐
       cially when response times differ at times) and printing "*"  instead
       of  a  time. In such a case, switch this algorithm off, by specifying
       -w with the desired timeout only (for example, -w 5).

       If some hops report nothing for every  method,  the  last  chance  to
       obtain  something  is to use ping -R command (IPv4, and for nearest 8
       hops only).

SEE ALSO
       ping(8), ping6(8), tcpdump(8), netstat(8)

Traceroute                     11 October 2006                 TRACEROUTE(1)

```

```
traceroute
```

```
Usage:
  traceroute [ -46dFITnreAUDV ] [ -f first_ttl ] [ -g gate,... ] [ -i device ] [ -m max_ttl ] [ -N squeries ] [ -p port ] [ -t tos ] [ -l flow_label ] [ -w MAX,HERE,NEAR ] [ -q nqueries ] [ -s src_addr ] [ -z sendwait ] [ --fwmark=num ] host [ packetlen ]
Options:
  -4                          Use IPv4
  -6                          Use IPv6
  -d  --debug                 Enable socket level debugging
  -F  --dont-fragment         Do not fragment packets
  -f first_ttl  --first=first_ttl
                              Start from the first_ttl hop (instead from 1)
  -g gate,...  --gateway=gate,...
                              Route packets through the specified gateway
                              (maximum 8 for IPv4 and 127 for IPv6)
  -I  --icmp                  Use ICMP ECHO for tracerouting
  -T  --tcp                   Use TCP SYN for tracerouting (default port is 80)
  -i device  --interface=device
                              Specify a network interface to operate with
  -m max_ttl  --max-hops=max_ttl
                              Set the max number of hops (max TTL to be
                              reached). Default is 30
  -N squeries  --sim-queries=squeries
                              Set the number of probes to be tried
                              simultaneously (default is 16)
  -n                          Do not resolve IP addresses to their domain names
  -p port  --port=port        Set the destination port to use. It is either
                              initial udp port value for "default" method
                              (incremented by each probe, default is 33434), or
                              initial seq for "icmp" (incremented as well,
                              default from 1), or some constant destination
                              port for other methods (with default of 80 for
                              "tcp", 53 for "udp", etc.)
  -t tos  --tos=tos           Set the TOS (IPv4 type of service) or TC (IPv6
                              traffic class) value for outgoing packets
  -l flow_label  --flowlabel=flow_label
                              Use specified flow_label for IPv6 packets
  -w MAX,HERE,NEAR  --wait=MAX,HERE,NEAR
                              Wait for a probe no more than HERE (default 3)
                              times longer than a response from the same hop,
                              or no more than NEAR (default 10) times than some
                              next hop, or MAX (default 5.0) seconds (float
                              point values allowed too)
  -q nqueries  --queries=nqueries
                              Set the number of probes per each hop. Default is
                              3
  -r                          Bypass the normal routing and send directly to a
                              host on an attached network
  -s src_addr  --source=src_addr
                              Use source src_addr for outgoing packets
  -z sendwait  --sendwait=sendwait
                              Minimal time interval between probes (default 0).
                              If the value is more than 10, then it specifies a
                              number in milliseconds, else it is a number of
                              seconds (float point values allowed too)
  -e  --extensions            Show ICMP extensions (if present), including MPLS
  -A  --as-path-lookups       Perform AS path lookups in routing registries and
                              print results directly after the corresponding
                              addresses
  -M name  --module=name      Use specified module (either builtin or external)
                              for traceroute operations. Most methods have
                              their shortcuts (`-I' means `-M icmp' etc.)
  -O OPTS,...  --options=OPTS,...
                              Use module-specific option OPTS for the
                              traceroute module. Several OPTS allowed,
                              separated by comma. If OPTS is "help", print info
                              about available options
  --sport=num                 Use source port num for outgoing packets. Implies
                              `-N 1'
  --fwmark=num                Set firewall mark for outgoing packets
  -U  --udp                   Use UDP to particular port for tracerouting
                              (instead of increasing the port per each probe),
                              default port is 53
  -UL                         Use UDPLITE for tracerouting (default dest port
                              is 53)
  -D  --dccp                  Use DCCP Request for tracerouting (default port
                              is 33434)
  -P prot  --protocol=prot    Use raw packet of protocol prot for tracerouting
  --mtu                       Discover MTU along the path being traced. Implies
                              `-F -N 1'
  --back                      Guess the number of hops in the backward path and
                              print if it differs
  -V  --version               Print version info and exit
  --help                      Read this help and exit

Arguments:
+     host          The host to traceroute to
      packetlen     The full packet length (default is the length of an IP
                    header plus 40). Can be ignored or increased to a minimal
                    allowed value

```

```
//NUIST
$ traceroute XXX.net      //成功
traceroute to XXX.net (172.XXX.XXX.XXX), 30 hops max, 60 byte packets
 1  10.0.255.254 (10.0.255.254)  12.236 ms  12.466 ms  12.842 ms
 2  172.255.0.17 (172.255.0.17)  1.383 ms  1.703 ms  1.828 ms
 3  * * *
 4  211.65.207.77 (211.65.207.77)  6.093 ms 211.65.207.21 (211.65.207.21)  6.319 ms 211.65.207.77 (211.65.207.77)  6.721 ms
 5  101.4.116.222 (101.4.116.222)  5.298 ms 101.4.116.218 (101.4.116.218)  5.399 ms 101.4.116.105 (101.4.116.105)  5.960 ms
 6  101.4.112.42 (101.4.112.42)  12.967 ms 101.4.117.25 (101.4.117.25)  7.938 ms 101.4.112.42 (101.4.112.42)  11.507 ms
 7  101.4.117.30 (101.4.117.30)  42.283 ms  39.939 ms  39.886 ms
 8  101.4.117.38 (101.4.117.38)  37.393 ms 101.4.116.118 (101.4.116.118)  39.181 ms 101.4.117.38 (101.4.117.38)  37.123 ms
 9  101.4.112.69 (101.4.112.69)  38.658 ms  36.523 ms 101.4.112.1 (101.4.112.1)  34.868 ms
10  101.4.114.194 (101.4.114.194)  33.799 ms 101.4.113.109 (101.4.113.109)  32.864 ms  33.260 ms
11  101.4.118.26 (101.4.118.26)  37.468 ms 101.4.114.174 (101.4.114.174)  37.397 ms 101.4.118.26 (101.4.118.26)  37.665 ms
12  101.4.117.150 (101.4.117.150)  175.256 ms 101.4.118.26 (101.4.118.26)  37.406 ms  37.406 ms
13  61.8.59.37 (61.8.59.37)  185.770 ms  185.778 ms 101.4.117.150 (101.4.117.150)  172.632 ms
14  i-91.hkth-core02.telstraglobal.net (202.84.153.25)  216.492 ms 61.8.59.37 (61.8.59.37)  198.159 ms  198.539 ms
15  i-92.hkth12.telstraglobal.net (202.84.153.38)  231.299 ms i-0-5-0-5.hkth12.telstraglobal.net (202.84.173.22)  231.696 ms  232.120 ms
16  i-0-5-0-5.hkth12.telstraglobal.net (202.84.173.22)  229.983 ms ae1-125.cr1-hkg1.ip4.gtt.net (183.182.80.121)  270.571 ms  271.064 ms
17  et-0-0-59.cr3-lax2.ip4.gtt.net (89.149.130.94)  247.926 ms ae1-125.cr1-hkg1.ip4.gtt.net (183.182.80.121)  266.960 ms et-0-0-47.cr3-lax2.ip4.gtt.net (89.149.141.125)  247.520 ms
18  ip4.gtt.net (69.174.6.174)  279.924 ms et-0-0-47.cr3-lax2.ip4.gtt.net (89.149.141.125)  246.325 ms ip4.ceranetworks.com (69.174.2.154)  282.185 ms
19  23.225.225.221 (23.225.225.221)  249.050 ms ip4.gtt.net (69.174.6.174)  276.411 ms 23.225.225.221 (23.225.225.221)  247.393 ms
20  23.225.225.1 (23.225.225.1)  278.334 ms * 192.168.206.25 (192.168.206.25)  254.390 ms
21  900gbps-a.suite101-1200street (23.224.58.2)  287.459 ms *  287.883 ms
22  900gbps-a.suite101-1200street (23.224.58.2)  285.432 ms  286.349 ms  286.115 ms
23  23.225.225.22 (23.225.225.22)  288.666 ms  289.286 ms *
24  n21.sexpay.top (172.XXX.XXX.XXX)  359.110 ms !X  360.694 ms !X  360.689 ms !X


$ traceroute XXX.net		//成功
traceroute to XXX.net (172.XXX.XXX.XXX), 30 hops max, 60 byte packets
 1  10.0.255.254 (10.0.255.254)  2.077 ms  2.953 ms  3.639 ms
 2  172.255.0.17 (172.255.0.17)  3.182 ms  4.127 ms  4.279 ms
 3  * * *
 4  202.112.53.133 (202.112.53.133)  8.110 ms 211.65.207.73 (211.65.207.73)  8.274 ms  15.675 ms
 5  101.4.116.222 (101.4.116.222)  10.929 ms 101.4.116.105 (101.4.116.105)  10.724 ms 101.4.112.65 (101.4.112.65)  11.089 ms
 6  101.4.112.42 (101.4.112.42)  15.537 ms  26.035 ms 101.4.117.25 (101.4.117.25)  13.354 ms
 7  101.4.112.61 (101.4.112.61)  12.266 ms  12.624 ms 101.4.117.30 (101.4.117.30)  30.635 ms
 8  101.4.116.118 (101.4.116.118)  35.910 ms 101.4.117.38 (101.4.117.38)  24.159 ms 101.4.116.118 (101.4.116.118)  35.911 ms
 9  101.4.112.69 (101.4.112.69)  35.914 ms  36.042 ms  36.662 ms
10  * 101.4.115.253 (101.4.115.253)  35.988 ms *
11  101.4.114.170 (101.4.114.170)  33.722 ms 101.4.115.253 (101.4.115.253)  63.113 ms 101.4.114.57 (101.4.114.57)  35.252 ms
12  101.4.118.122 (101.4.118.122)  37.591 ms 101.4.114.57 (101.4.114.57)  33.045 ms 101.4.118.122 (101.4.118.122)  37.458 ms
13  101.4.118.122 (101.4.118.122)  33.419 ms 101.4.117.150 (101.4.117.150)  170.866 ms  171.085 ms
14  101.4.117.150 (101.4.117.150)  168.668 ms 61.8.59.37 (61.8.59.37)  256.320 ms  256.146 ms
15  i-91.hkth-core02.telstraglobal.net (202.84.153.25)  258.749 ms i-96.hkck-core01.telstraglobal.net (202.84.157.38)  259.077 ms 61.8.59.37 (61.8.59.37)  254.176 ms
16  i-0-5-0-5.hkth12.telstraglobal.net (202.84.173.22)  233.984 ms i-91.hkth-core02.telstraglobal.net (202.84.153.25)  256.536 ms i-92.hkth12.telstraglobal.net (202.84.153.38)  234.256 ms
17  ae1-125.cr1-hkg1.ip4.gtt.net (183.182.80.121)  259.715 ms  259.947 ms  260.199 ms
18  et-0-0-47.cr3-lax2.ip4.gtt.net (89.149.141.125)  256.856 ms ae1-125.cr1-hkg1.ip4.gtt.net (183.182.80.121)  274.929 ms  275.043 ms
19  et-0-0-47.cr3-lax2.ip4.gtt.net (89.149.141.125)  254.755 ms  255.707 ms  255.303 ms
20  ip4.gtt.net (69.174.6.174)  403.640 ms 23.225.225.221 (23.225.225.221)  290.821 ms  290.699 ms
21  192.168.206.13 (192.168.206.13)  293.049 ms 23.225.225.221 (23.225.225.221)  289.242 ms  288.700 ms
22  900gbps-a.suite101-1200street (23.224.58.2)  291.423 ms  289.208 ms  289.749 ms
23  23.225.225.22 (23.225.225.22)  293.897 ms 900gbps-a.suite101-1200street (23.224.58.2)  287.697 ms  286.963 ms
24  n21.sexpay.top (172.XXX.XXX.XXX)  283.936 ms !X 23.225.225.22 (23.225.225.22)  290.057 ms n21.sexpay.top (172.XXX.XXX.XXX)  283.006 ms !X

$ traceroute XXX.net
traceroute to XXX.net (172.XXX.XXX.XXX), 30 hops max, 60 byte packets
 1  10.0.255.254 (10.0.255.254)  1.127 ms  1.540 ms  1.840 ms
 2  172.255.0.17 (172.255.0.17)  2.264 ms  2.700 ms  4.001 ms
 3  * * *
 4  211.65.207.21 (211.65.207.21)  5.491 ms  7.085 ms 202.112.53.133 (202.112.53.133)  6.896 ms
 5  101.4.112.65 (101.4.112.65)  5.623 ms 101.4.116.218 (101.4.116.218)  6.330 ms 101.4.116.105 (101.4.116.105)  6.712 ms
 6  101.4.112.42 (101.4.112.42)  29.750 ms 101.4.117.25 (101.4.117.25)  6.450 ms 101.4.112.42 (101.4.112.42)  21.406 ms
 7  101.4.117.30 (101.4.117.30)  30.840 ms 101.4.112.61 (101.4.112.61)  12.511 ms 101.4.117.30 (101.4.117.30)  30.835 ms
 8  101.4.117.38 (101.4.117.38)  24.490 ms  24.508 ms *
 9  * * *
10  * * *
..................
30  * * *


```



```
//NUIST
$ traceroute -m 50 github.com
traceroute to github.com (13.250.177.223), 50 hops max, 60 byte packets
 1  10.0.255.254 (10.0.255.254)  1.790 ms  2.212 ms  5.093 ms
 2  172.255.0.17 (172.255.0.17)  2.386 ms  3.116 ms  4.686 ms
 3  * * *
 4  211.65.207.73 (211.65.207.73)  8.703 ms 211.65.207.21 (211.65.207.21)  8.146 ms 211.65.207.77 (211.65.207.77)  8.589 ms
 5  101.4.116.222 (101.4.116.222)  7.459 ms 101.4.112.65 (101.4.112.65)  7.668 ms 101.4.116.105 (101.4.116.105)  7.908 ms
 6  101.4.112.42 (101.4.112.42)  18.028 ms 101.4.117.25 (101.4.117.25)  6.887 ms  10.031 ms
 7  101.4.117.30 (101.4.117.30)  31.468 ms  31.480 ms 101.4.112.61 (101.4.112.61)  12.882 ms
 8  101.4.117.38 (101.4.117.38)  24.354 ms 101.4.116.118 (101.4.116.118)  36.079 ms  36.093 ms
 9  101.4.112.1 (101.4.112.1)  36.852 ms 101.4.112.69 (101.4.112.69)  34.687 ms 101.4.112.1 (101.4.112.1)  37.050 ms
10  101.4.113.109 (101.4.113.109)  32.694 ms 101.4.114.170 (101.4.114.170)  36.337 ms 101.4.113.109 (101.4.113.109)  31.580 ms
11  101.4.118.26 (101.4.118.26)  36.731 ms 101.4.114.222 (101.4.114.222)  33.830 ms 101.4.118.26 (101.4.118.26)  34.181 ms
12  101.4.118.26 (101.4.118.26)  35.503 ms  35.486 ms  34.245 ms
13  101.4.117.150 (101.4.117.150)  171.352 ms 61.8.59.37 (61.8.59.37)  223.191 ms 101.4.117.150 (101.4.117.150)  171.015 ms
14  i-96.hkck-core01.telstraglobal.net (202.84.157.38)  228.246 ms i-91.hkth-core02.telstraglobal.net (202.84.153.25)  224.999 ms 61.8.59.37 (61.8.59.37)  252.529 ms
15  i-14252.jtha-core02.telstraglobal.net (202.84.141.130)  278.579 ms i-96.hkck-core01.telstraglobal.net (202.84.157.38)  225.226 ms  225.207 ms
16  i-0-7-0-7.siko11.telstraglobal.net (202.47.216.250)  259.852 ms i-14252.jtha-core02.telstraglobal.net (202.84.141.130)  276.108 ms i-0-7-0-7.siko11.telstraglobal.net (202.47.216.250)  260.654 ms
17  i-0-7-0-7.siko11.telstraglobal.net (202.47.216.250)  254.919 ms  260.544 ms  258.137 ms
18  unknown.telstraglobal.net (134.159.98.79)  263.527 ms * *
19  * * *
20  * 54.239.52.101 (54.239.52.101)  255.514 ms *
21  52.95.30.38 (52.95.30.38)  258.148 ms 52.95.30.54 (52.95.30.54)  263.417 ms *
22  * * 52.95.30.52 (52.95.30.52)  258.378 ms
23  * * *
24  * * 54.239.43.114 (54.239.43.114)  283.270 ms
25  52.93.8.176 (52.93.8.176)  322.379 ms * 54.239.43.114 (54.239.43.114)  292.128 ms
26  52.93.8.84 (52.93.8.84)  281.424 ms 52.93.8.88 (52.93.8.88)  330.969 ms *
27  52.93.11.42 (52.93.11.42)  250.639 ms 52.93.8.152 (52.93.8.152)  356.757 ms 52.93.11.54 (52.93.11.54)  282.197 ms
28  52.93.11.8 (52.93.11.8)  289.046 ms 52.93.11.20 (52.93.11.20)  276.373 ms 52.93.8.108 (52.93.8.108)  360.213 ms
29  52.93.11.28 (52.93.11.28)  297.627 ms 203.83.223.196 (203.83.223.196)  278.878 ms 52.93.11.30 (52.93.11.30)  286.366 ms
30  * * 52.93.11.14 (52.93.11.14)  286.796 ms
31  * 52.93.8.27 (52.93.8.27)  279.885 ms *
32  * * *
33  * * *
..................
50  * * *


$ traceroute github.com
traceroute to github.com (13.250.177.223), 30 hops max, 60 byte packets
 1  10.0.255.254 (10.0.255.254)  0.906 ms  1.156 ms  1.792 ms
 2  172.255.0.17 (172.255.0.17)  2.470 ms  2.773 ms  2.909 ms
 3  * * *
 4  211.65.207.73 (211.65.207.73)  21.279 ms 211.65.207.77 (211.65.207.77)  7.326 ms 211.65.207.73 (211.65.207.73)  21.498 ms
 5  101.4.116.105 (101.4.116.105)  6.131 ms 101.4.112.65 (101.4.112.65)  6.565 ms  6.766 ms
 6  101.4.112.42 (101.4.112.42)  13.960 ms  9.961 ms 101.4.117.25 (101.4.117.25)  6.175 ms
 7  101.4.117.30 (101.4.117.30)  29.086 ms 101.4.112.61 (101.4.112.61)  12.784 ms 101.4.117.30 (101.4.117.30)  29.095 ms
 8  101.4.116.118 (101.4.116.118)  34.816 ms  34.835 ms  34.833 ms
 9  101.4.112.1 (101.4.112.1)  31.861 ms  31.967 ms *
10  * * *
11  * * *
.............
30  * * *


$ traceroute google.com
traceroute to google.com (172.217.160.78), 30 hops max, 60 byte packets
 1  10.0.255.254 (10.0.255.254)  3.414 ms  4.809 ms  4.970 ms
 2  172.255.0.17 (172.255.0.17)  2.365 ms  2.595 ms  2.814 ms
 3  * * *
 4  211.65.207.77 (211.65.207.77)  8.438 ms 211.65.207.21 (211.65.207.21)  8.882 ms 211.65.207.77 (211.65.207.77)  9.025 ms
 5  101.4.112.65 (101.4.112.65)  7.023 ms 101.4.116.105 (101.4.116.105)  7.835 ms 101.4.112.65 (101.4.112.65)  8.159 ms
 6  101.4.112.42 (101.4.112.42)  16.272 ms 101.4.117.25 (101.4.117.25)  7.986 ms 101.4.112.42 (101.4.112.42)  13.853 ms
 7  * * *
 8  101.4.116.118 (101.4.116.118)  37.327 ms 101.4.117.38 (101.4.117.38)  22.157 ms  22.171 ms
 9  101.4.112.1 (101.4.112.1)  32.538 ms 101.4.112.69 (101.4.112.69)  45.525 ms *
10  * * *
11  * * *
..............

30  * * *




$ traceroute www.baidu.com
traceroute to www.baidu.com (180.101.49.12), 30 hops max, 60 byte packets
 1  10.0.255.254 (10.0.255.254)  17.464 ms  17.593 ms  18.029 ms
 2  172.255.0.17 (172.255.0.17)  2.088 ms  2.398 ms  2.729 ms
 3  192.168.5.1 (192.168.5.1)  12.960 ms  13.118 ms  13.532 ms
 4  221.231.175.41 (221.231.175.41)  20.339 ms  20.346 ms  24.389 ms
 5  * * *
 6  58.213.94.54 (58.213.94.54)  5.743 ms  6.250 ms  9.080 ms
 7  * * 58.213.94.126 (58.213.94.126)  7.901 ms
 8  58.213.96.106 (58.213.96.106)  5.543 ms 58.213.96.102 (58.213.96.102)  5.269 ms 58.213.96.98 (58.213.96.98)  5.283 ms
 9  * * *
10  * * *
.............
30  * * *


```



```
//ZS301
$ traceroute github.com
traceroute to github.com (13.250.177.223), 30 hops max, 60 byte packets
 1  * * *
 2  * * *
 3  * * *
 4  * * *
 5  * * *
 ............
 30  * * *
 
 $ traceroute www.baidu.com
traceroute to www.baidu.com (180.101.49.12), 30 hops max, 60 byte packets
 1  OpenWrt.lan (172.16.0.2)  2.362 ms  2.357 ms *
 2  172.16.0.1 (172.16.0.1)  2.340 ms  2.336 ms  3.151 ms
 3  * * *
 4  * * *
.............
 30  * * *

```









## 参考

+ <https://zh.wikipedia.org/wiki/Traceroute>
+ <https://blog.csdn.net/fsdev/article/details/7884162>



## 外部链接

- [在线traceroute工具](http://www.traceroute.org/)
- [TRACEROUTE6.net](http://www.traceroute6.net/): 在亚洲区含IPv4 和 IPv6 的在线traceroute工具
- （英文） [Traceroute test](http://www.test-net.org/traceroute/)
- [在线Traceroute路由器追踪工具](https://myipaddress.pro/cn/traceroute)